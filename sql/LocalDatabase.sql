CREATE TABLE JOBS (
    JOB_ID            VARCHAR2(10) PRIMARY KEY,
    JOB_TITLE         VARCHAR2(35) NOT NULL,
    MIN_SALARY        NUMBER(6),
    MAX_SALARY        NUMBER(6)
);

-- DEPARTMENTS table creation for the foreign key constraint
CREATE TABLE DEPARTMENTS (
    DEPARTMENT_ID     NUMBER(4) PRIMARY KEY,
    DEPARTMENT_NAME   VARCHAR2(30) NOT NULL,
    MANAGER_ID        NUMBER(6),
    LOCATION_ID       NUMBER(4)
);

create table EMPLOYEES(
EMPLOYEE_ID NUMBER(6) PRIMARY KEY,
FIRST_NAME VARCHAR2(20),
LAST_NAME VARCHAR2(30) NOT NULL,
EMAIL VARCHAR2(50) NOT NULL UNIQUE,
PHONE_NUMBER VARCHAR2(25),
HIRE_DATE DATE NOT NULL,
JOB_ID VARCHAR2(20) NOT NULL,
SALARY NUMBER(8,2),
MANAGER_ID NUMBER(6),
DEPARTMENT_ID NUMBER(6),

CONSTRAINT FK_JOB FOREIGN KEY(JOB_ID)
REFERENCES JOBS(JOB_ID),

CONSTRAINT FK_MANAGER FOREIGN KEY(MANAGER_ID)
REFERENCES EMPLOYEES(EMPLOYEE_ID),

CONSTRAINT FK_DEPARTMENT FOREIGN KEY(DEPARTMENT_ID)
REFERENCES DEPARTMENTS(DEPARTMENT_ID)
);


INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY) VALUES ('IT_PROG', 'Programmer', 4000, 10000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY) VALUES ('AD_ASST', 'Admin Assistant', 3000, 9000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY) VALUES ('CEO', 'Founder', 1000, 10000);

INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID) VALUES (10, 'Administration', 101, 1700);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID) VALUES (20, 'IT', 102, 1800);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY,  MANAGER_ID, DEPARTMENT_ID)
VALUES (101, 'Larry', 'Page', 'larryPage@google.com', '123-456-7891', TO_DATE('1993-01-15', 'YYYY-MM-DD'), 'CEO', 5000, null, 10);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY,  MANAGER_ID, DEPARTMENT_ID)
VALUES (102, 'Sunder', 'Piche', 'sunder@google.com', '123-456-7892', TO_DATE('1993-01-15', 'YYYY-MM-DD'), 'CEO', 4000, null, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY,  MANAGER_ID, DEPARTMENT_ID)
VALUES (1001, 'John', 'Doe', 'johndoe@example.com', '123-456-7890', TO_DATE('2021-01-15', 'YYYY-MM-DD'), 'IT_PROG', 6000, 102, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY,  MANAGER_ID, DEPARTMENT_ID)
VALUES (1004, 'Praneeth', 'Diguvapalem', 'praneeth.chakri26@gmai.com', '123-456-7890', TO_DATE('2024-10-15', 'YYYY-MM-DD'), 'IT_PROG', 7000, 102, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY,  MANAGER_ID, DEPARTMENT_ID)
VALUES (1002, 'Jane', 'Smith', 'janesmith@example.com', '987-654-3210', TO_DATE('2021-02-10', 'YYYY-MM-DD'), 'AD_ASST', 4500, 101, 10);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY,  MANAGER_ID, DEPARTMENT_ID)
VALUES (1003, 'Sushma', 'Prasad', 'Sushmapraneeth9391@gmail.com', '987-654-3210', TO_DATE('2024-08-10', 'YYYY-MM-DD'), 'AD_ASST', 9000, 101, 10);

COMMIT;


-- Write AVG Salary of employees in each department
SELECT  E.department_id,AVG(E.SALARY) AS AVG_SALARY FROM EMPLOYEES E GROUP BY E.DEPARTMENT_ID;

--WRITE AN SQL QUERY TO FETCHT THE EMPLOYEES WHO SALARY IS GRT THEIR MANAGERS
SELECT emp.* FROM EMPLOYEES emp 
inner join 
Employees mgr 
on emp.manager_id = mgr.employee_id
where emp.salary>mgr.salary;






